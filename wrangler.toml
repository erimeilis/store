name = "store-crud-api"
main = "src/index.ts"
compatibility_date = "2024-08-25"

# Production Environment (default)
[[d1_databases]]
binding = "DB"
database_name = "store-database"
database_id = "a293b988-9b67-4430-ad66-6d63e3cebf20"

[[r2_buckets]]
binding = "BUCKET"
bucket_name = "store-uploads"
preview_bucket_name = "store-uploads-preview"

[[kv_namespaces]]
binding = "KV"
id = "faf63b06f0cf4d5c969166dda943cf36"

[observability]
enabled = true
head_sampling_rate = 1

[vars]
NODE_ENV = "production"
API_URL = "https://store-crud-api.eri-42e.workers.dev"
ALLOWED_ORIGINS = "https://store-crud-front.eri-42e.workers.dev,https://store-crud-api.eri-42e.workers.dev"
PAGE_SIZE = "20"

# Local Environment (uses local D1 in .wrangler/state/)
[env.local]

[[env.local.d1_databases]]
binding = "DB"
database_name = "store-database-preview"
database_id = "6a7a4053-7868-45a6-839d-1bfa6c62f41c"
migrations_dir = "prisma/migrations"

[[env.local.r2_buckets]]
binding = "BUCKET"
bucket_name = "store-uploads-preview"

[[env.local.kv_namespaces]]
binding = "KV"
id = "1ddafd825d9a49828b814d0ac7ebe0d0"

[env.local.vars]
NODE_ENV = "development"
API_URL = "http://localhost:8787"
ALLOWED_ORIGINS = "http://localhost:5173,http://localhost:8787"
PAGE_SIZE = "5"

# Preview Environment (uses remote preview D1 on Cloudflare)
[env.preview]

[[env.preview.d1_databases]]
binding = "DB"
database_name = "store-database-preview"
database_id = "6a7a4053-7868-45a6-839d-1bfa6c62f41c"
experimental_remote = true

[[env.preview.r2_buckets]]
binding = "BUCKET"
bucket_name = "store-uploads-preview"
experimental_remote = true

[[env.preview.kv_namespaces]]
binding = "KV"
id = "1ddafd825d9a49828b814d0ac7ebe0d0"
experimental_remote = true

[env.preview.vars]
NODE_ENV = "preview"
API_URL = "http://localhost:8787"
ALLOWED_ORIGINS = "http://localhost:5173,http://localhost:8787"
PAGE_SIZE = "10"

[env.preview.observability]
enabled = true
head_sampling_rate = 1 # optional

# Production Environment (explicit configuration for remote access)
[env.production]

[[env.production.d1_databases]]
binding = "DB"
database_name = "store-database"
database_id = "a293b988-9b67-4430-ad66-6d63e3cebf20"

[[env.production.r2_buckets]]
binding = "BUCKET"
bucket_name = "store-uploads"

[[env.production.kv_namespaces]]
binding = "KV"
id = "faf63b06f0cf4d5c969166dda943cf36"

[env.production.vars]
NODE_ENV = "production"
API_URL = "https://store-crud-api.eri-42e.workers.dev"
ALLOWED_ORIGINS = "https://store-crud-front.eri-42e.workers.dev,https://store-crud-api.eri-42e.workers.dev"
PAGE_SIZE = "20"

[env.production.observability]
enabled = true
head_sampling_rate = 1 # optional
